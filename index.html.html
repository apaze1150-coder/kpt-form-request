<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>KPT Form Request ‡∏õ‡πâ‡∏≤‡∏¢ Promotion</title>
  <style>
    :root{
      --male:#1e3a8a; --female:#db2777;
      --bg:#f8fafc; --card:#ffffff; --line:#e5e7eb; --text:#0f172a; --muted:#475569;
      --accent: var(--male);
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans Thai","Noto Sans",sans-serif}
    body{margin:0;background:var(--bg);color:var(--text)}
    .wrap{max-width:860px;margin:32px auto;padding:0 16px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 8px 24px rgba(2,6,23,.06);padding:22px}
    .header{display:flex;align-items:center;gap:12px;margin-bottom:10px}
    h1{margin:0;font-size:1.35rem;color:var(--accent)}
    .gender-switch{margin-left:auto;display:flex;gap:8px}
    .gbtn{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);background:#fff;padding:8px 10px;border-radius:999px;cursor:pointer;font-weight:600;transition:all .15s}
    .gbtn[aria-pressed="true"]{border-color:var(--accent);box-shadow:0 0 0 4px color-mix(in srgb,var(--accent) 20%, transparent)}
    .male{color:var(--male)} .female{color:var(--female)}
    .grid{display:grid;gap:12px;margin-top:14px}
    label{font-weight:600}
    .hint{color:var(--muted);font-size:.92rem}
    input[type="text"],input[type="number"],textarea{
      width:100%;padding:11px 12px;border:1px solid #cbd5e1;border-radius:10px;background:#fff;outline:0;
      transition:border-color .15s, box-shadow .15s;
    }
    input:focus,textarea:focus{border-color:var(--accent);box-shadow:0 0 0 4px color-mix(in srgb,var(--accent) 20%, transparent)}
    textarea{min-height:140px;resize:vertical}
    /* SHOP ‡πÅ‡∏™‡∏î‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏™‡∏°‡∏≠‡πÉ‡∏ô UI */
    #shop{text-transform:uppercase}
    .sizes{display:grid;gap:10px}
    .size-row{display:grid;grid-template-columns:auto 120px 100px;gap:10px;align-items:center;padding:10px;border:1px dashed var(--line);border-radius:10px;background:#fbfdff}
    .size-row.disabled{opacity:.6}
    .qty-wrap{display:flex;align-items:center;gap:8px}
    .unit{color:var(--muted)}
    .btns{display:flex;flex-wrap:wrap;gap:10px;margin-top:8px}
    button{border:0;border-radius:999px;padding:11px 16px;cursor:pointer;font-weight:700;color:#fff;background:var(--accent);transition:transform .05s,opacity .15s,background .2s}
    button.secondary{background:#0f766e} button.ghost{background:#e2e8f0;color:#0f172a}
    button:active{transform:scale(.98)}
    .ok{color:#16a34a;margin-left:8px;opacity:0;transition:opacity .2s}
    .ok.show{opacity:1}
    .readonly{background:#f1f5f9}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="header">
        <h1>KPT Form Request ‡∏õ‡πâ‡∏≤‡∏¢ Promotion</h1>
        <div class="gender-switch" role="group" aria-label="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢">
          <button id="maleBtn" class="gbtn" aria-pressed="true" data-gender="male" title="‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô + ‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö">
            <span class="male">üöπ ‡∏ä‡∏≤‡∏¢</span>
          </button>
          <button id="femaleBtn" class="gbtn" aria-pressed="false" data-gender="female" title="‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π + ‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞">
            <span class="female">üö∫ ‡∏´‡∏ç‡∏¥‡∏á</span>
          </button>
        </div>
      </div>

      <div class="grid">
        <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) -->
        <div>
          <label for="dateShow">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å</label>
          <div class="hint">‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏™‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏Ñ.‡∏®.)</div>
          <input id="dateShow" type="text" class="readonly" readonly>
        </div>

        <div>
          <label for="shop">SHOP</label>
          <div class="hint">‡πÄ‡∏ä‡πà‡∏ô TE1, TW, Sat1 (‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà)</div>
          <input id="shop" type="text" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤">
        </div>

        <div>
          <label for="note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
          <textarea id="note" placeholder="‡∏ñ‡πâ‡∏≤‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ ‚Äú‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡∏õ‡πâ‡∏≤‡∏¢‚Äù ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥"></textarea>
        </div>

        <div>
          <label>‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î</label>
          <div class="sizes">
            <div class="size-row" data-size="A4">
              <label class="chk"><input type="checkbox" class="size-cb"> Size A4</label>
              <div class="qty-wrap">
                <label for="qtyA4">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                <input id="qtyA4" type="number" class="qty" min="1" step="1" placeholder="0" disabled>
              </div>
              <span class="unit">‡πÉ‡∏ö</span>
            </div>
            <div class="size-row" data-size="A5">
              <label class="chk"><input type="checkbox" class="size-cb"> Size A5</label>
              <div class="qty-wrap">
                <label for="qtyA5">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                <input id="qtyA5" type="number" class="qty" min="1" step="1" placeholder="0" disabled>
              </div>
              <span class="unit">‡πÉ‡∏ö</span>
            </div>
            <div class="size-row" data-size="Name card">
              <label class="chk"><input type="checkbox" class="size-cb"> Size Name card</label>
              <div class="qty-wrap">
                <label for="qtyNC">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                <input id="qtyNC" type="number" class="qty" min="1" step="1" placeholder="0" disabled>
              </div>
              <span class="unit">‡πÉ‡∏ö</span>
            </div>
            <div class="size-row" data-size="Shelf Talk">
              <label class="chk"><input type="checkbox" class="size-cb"> Size Shelf Talk</label>
              <div class="qty-wrap">
                <label for="qtyST">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                <input id="qtyST" type="number" class="qty" min="1" step="1" placeholder="0" disabled>
              </div>
              <span class="unit">‡πÉ‡∏ö</span>
            </div>
          </div>
        </div>

        <div class="btns">
          <button id="genBtn">‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
          <button id="copyBtn" class="secondary">‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
          <button id="clearBtn" class="ghost">‡∏õ‡∏∏‡πà‡∏° Clear</button>
          <span id="copied" class="ok">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úì</span>
        </div>

        <div>
          <label for="output">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</label>
          <textarea id="output" readonly placeholder="‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏î ‚Äò‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‚Äô"></textarea>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ---------- ‡πÄ‡∏û‡∏® & ‡πÇ‡∏ó‡∏ô‡∏™‡∏µ ----------
    let gender = 'male';
    const maleBtn = document.getElementById('maleBtn');
    const femaleBtn = document.getElementById('femaleBtn');
    function setGender(g){
      gender = g;
      const root = document.documentElement;
      root.style.setProperty('--accent', g==='male'
        ? getComputedStyle(root).getPropertyValue('--male')
        : getComputedStyle(root).getPropertyValue('--female'));
      maleBtn.setAttribute('aria-pressed', g==='male');
      femaleBtn.setAttribute('aria-pressed', g==='female');
    }
    maleBtn.addEventListener('click', ()=>setGender('male'));
    femaleBtn.addEventListener('click', ()=>setGender('female'));

    // ---------- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) ----------
    const dateShow = document.getElementById('dateShow');
    function setTodayText(){
      const t = new Date();
      const y = t.getFullYear();
      const m = String(t.getMonth()+1).padStart(2,'0');
      const d = String(t.getDate()).padStart(2,'0');
      dateShow.value = `${d}/${m}/${y}`; // ‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏Ñ.‡∏®.
      return dateShow.value;
    }
    setTodayText();

    // ---------- ‡∏≠‡∏¥‡∏ô‡∏û‡∏∏‡∏ï SHOP & ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ ----------
    const elShop = document.getElementById('shop');
    const elNote = document.getElementById('note');
    const output = document.getElementById('output');
    const copied = document.getElementById('copied');

    // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö SHOP ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏ì‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå
    elShop.addEventListener('input', ()=>{ elShop.value = elShop.value.toUpperCase(); });

    // ---------- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ö‡πá‡∏≠‡∏Å‡∏ã‡πå & ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ----------
    document.querySelectorAll('.size-row').forEach(row=>{
      const cb  = row.querySelector('.size-cb');
      const qty = row.querySelector('.qty');
      const toggle = ()=>{
        qty.disabled = !cb.checked;
        row.classList.toggle('disabled', !cb.checked);
        if(!cb.checked){ qty.value = ''; }
      };
      toggle();
      cb.addEventListener('change', toggle);
    });

    // ---------- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ----------
    function buildMessage(){
      const dateFmt = dateShow.value;
      const shop = (elShop.value || '').trim().toUpperCase();
      // ‡∏ñ‡πâ‡∏≤ ‚Äú‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‚Äù ‡∏ß‡πà‡∏≤‡∏á ‚Üí ‡πÉ‡∏ä‡πâ ‚Äú‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡∏õ‡πâ‡∏≤‡∏¢‚Äù
      const note = (elNote.value || '').trim() || '‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡∏õ‡πâ‡∏≤‡∏¢';

      if(!shop){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å SHOP'); elShop.focus(); return; }

      const linesSize = [];
      document.querySelectorAll('.size-row').forEach(row=>{
        const cb  = row.querySelector('.size-cb');
        const qty = row.querySelector('.qty');
        const sizeName = row.getAttribute('data-size');
        if(cb.checked){
          const n = parseInt(qty.value,10);
          if(!n || n<=0){ qty.focus(); throw new Error(`‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Size ${sizeName}`); }
          linesSize.push(`- Size ${sizeName} = ${n} ‡πÉ‡∏ö`);
        }
      });

      const closing = gender === 'male' ? '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö' : '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞';

      const lines = [
        'KPT Form Request ‡∏õ‡πâ‡∏≤‡∏¢ Promotion',
        `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å: ${dateFmt}`,
        `SHOP: ${shop}`,
        `‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ${note}`,
        ...(linesSize.length ? ['‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:', ...linesSize] : ['(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î)']),
        closing
      ];
      output.value = lines.join('\n');
    }

    // ---------- ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å & ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå ----------
    async function copyOut(){
      const text = output.value.trim();
      if(!text){ alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å'); return; }
      try{
        await navigator.clipboard.writeText(text);
        copied.classList.add('show');
        setTimeout(()=>copied.classList.remove('show'), 1400);
      }catch(_){
        output.select(); document.execCommand('copy');
        copied.classList.add('show');
        setTimeout(()=>copied.classList.remove('show'), 1400);
      }
    }

    function clearAll(){
      setTodayText();
      elShop.value = '';
      elNote.value = '';
      output.value = '';
      document.querySelectorAll('.size-row').forEach(row=>{
        const cb  = row.querySelector('.size-cb');
        const qty = row.querySelector('.qty');
        cb.checked = false; qty.value = ''; qty.disabled = true; row.classList.add('disabled');
      });
      setGender('male');
      elShop.focus();
    }

    // ---------- ‡∏õ‡∏∏‡πà‡∏° ----------
    document.getElementById('genBtn').addEventListener('click', ()=>{
      try{ buildMessage(); }catch(e){ if(e?.message) alert(e.message); }
    });
    document.getElementById('copyBtn').addEventListener('click', copyOut);
    document.getElementById('clearBtn').addEventListener('click', clearAll);
  </script>
</body>
</html>
